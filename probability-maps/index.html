<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Herman Trading ‚Äì Probability Maps</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React + ReactDOM + Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        background: #020617;
      }
    </style>
  </head>
  <body>
    <div id="root" class="min-h-screen"></div>

    <script type="text/babel">
      const { useState, useRef } = React;

      // Proste ikonki zamiast lucide-react (emoji / znaki)
      const ChevronRight = ({ size = 16 }) => (
        <span style={{ fontSize: size }}>‚Ä∫</span>
      );
      const ChevronLeft = ({ size = 16 }) => (
        <span style={{ fontSize: size }}>‚Äπ</span>
      );
      const Play = ({ size = 16 }) => (
        <span style={{ fontSize: size }}>‚ñ∂</span>
      );
      const BarChart2 = ({ size = 24 }) => (
        <span style={{ fontSize: size }}>üìä</span>
      );
      const Clock = ({ size = 24 }) => (
        <span style={{ fontSize: size }}>‚è±</span>
      );
      const Globe = ({ size = 24 }) => (
        <span style={{ fontSize: size }}>üåç</span>
      );
      const TrendingUp = ({ size = 24 }) => (
        <span style={{ fontSize: size }}>üìà</span>
      );
      const Target = ({ size = 24 }) => (
        <span style={{ fontSize: size }}>üéØ</span>
      );
      const Database = ({ size = 24 }) => (
        <span style={{ fontSize: size }}>üíæ</span>
      );
      const ShoppingCart = ({ size = 18 }) => (
        <span style={{ fontSize: size }}>üõí</span>
      );
      const Youtube = ({ size = 18 }) => (
        <span style={{ fontSize: size }}>‚ñ∂</span>
      );
      const Twitter = ({ size = 18 }) => (
        <span style={{ fontSize: size }}>ùïè</span>
      );
      const MessageCircle = ({ size = 18 }) => (
        <span style={{ fontSize: size }}>üí¨</span>
      );
      const TerminalIcon = ({ size = 12 }) => (
        <span style={{ fontSize: size }}>‚å®</span>
      );
      const Brain = ({ size = 24 }) => (
        <span style={{ fontSize: size }}>üß†</span>
      );
      const ShieldCheck = ({ size = 24 }) => (
        <span style={{ fontSize: size }}>‚úÖ</span>
      );

      // --- Social Link component ---
      const SocialLink = ({ href, icon: Icon, label }) => (
        <a
          href={href}
          target="_blank"
          rel="noopener noreferrer"
          className="flex items-center justify-center gap-2 py-2 px-4 bg-slate-900 hover:bg-slate-800 border border-slate-800 text-slate-300 rounded text-xs font-medium transition-colors"
        >
          <Icon size={14} /> {label}
        </a>
      );

      // --- Visual Canvas Component ---
      const VisualCanvas = ({ mode, state }) => {
        const width = 600;
        const height = 400;

        const generateCandles = (
          seed,
          count,
          trend,
          startPrice = 200
        ) => {
          let price = startPrice;
          return Array.from({ length: count }).map((_, i) => {
            const vol = trend === "volatile" ? 25 : 8;
            const bias = trend === "up" ? 4 : trend === "down" ? -4 : 0;
            const move =
              Math.sin(i * seed) * vol + bias + (Math.random() * 5 - 2.5);
            const open = price;
            const close = price + move;
            const high = Math.max(open, close) + Math.random() * 8;
            const low = Math.min(open, close) - Math.random() * 8;
            price = close;
            return { x: i * 25 + 50, open, close, high, low };
          });
        };

        let candles = [];
        let overlay = null;

        switch (mode) {
          case "intro": {
            candles = [];
            const dataPoints = Array.from({ length: 40 }).map((_, i) => ({
              x: Math.random() * width,
              y: Math.random() * height,
              val: Math.random() > 0.5 ? "1" : "0",
              opacity: Math.random(),
            }));

            overlay = (
              <g>
                {dataPoints.map((d, i) => (
                  <text
                    key={i}
                    x={d.x}
                    y={d.y}
                    fill="#10b981"
                    fontSize="10"
                    opacity={d.opacity * (1 - state.progress)}
                  >
                    {d.val}
                  </text>
                ))}

                <g transform="translate(300, 200)">
                  <circle
                    r={100 * state.progress}
                    fill="none"
                    stroke="#10b981"
                    strokeWidth="2"
                    opacity={1 - state.progress}
                  />
                  <text
                    y="-20"
                    textAnchor="middle"
                    fill="#10b981"
                    fontSize="48"
                    fontWeight="bold"
                    opacity={state.progress}
                  >
                    {Math.floor(state.progress * 81)}%
                  </text>
                  <text
                    y="20"
                    textAnchor="middle"
                    fill="white"
                    fontSize="16"
                    opacity={state.progress}
                  >
                    PROBABILITY
                  </text>
                  <text
                    y="40"
                    textAnchor="middle"
                    fill="#64748b"
                    fontSize="12"
                    opacity={state.progress}
                  >
                    Based on 10 Years Data
                  </text>
                </g>
              </g>
            );
            break;
          }

          case "data": {
            candles = [];
            overlay = (
              <g>
                <circle
                  cx="300"
                  cy="150"
                  r="40"
                  fill="#020617"
                  stroke="#64748b"
                  strokeWidth="2"
                />
                <text
                  x="300"
                  y="150"
                  textAnchor="middle"
                  fill="#64748b"
                  fontSize="26"
                  fontWeight="bold"
                  dy="8"
                >
                  DATA
                </text>
                <text
                  x="300"
                  y="210"
                  textAnchor="middle"
                  fill="#10b981"
                  fontSize="18"
                  fontWeight="bold"
                >
                  PYTHON + JUPYTER
                </text>
                <text
                  x="300"
                  y="235"
                  textAnchor="middle"
                  fill="white"
                  fontSize="13"
                >
                  POWERED BACKTESTING ENGINE
                </text>
                <rect
                  x="150"
                  y="270"
                  width="300"
                  height="4"
                  fill="#1e293b"
                  rx="2"
                />
                <rect
                  x="150"
                  y="270"
                  width={300 * state.progress}
                  height="4"
                  fill="#10b981"
                  rx="2"
                />
                <text
                  x="300"
                  y="300"
                  textAnchor="middle"
                  fill="#94a3b8"
                  fontSize="12"
                >
                  Scanning 72 Variants... {Math.round(state.progress * 100)}%
                </text>
              </g>
            );
            break;
          }

          case "ny_session": {
            candles = generateCandles(0.8, 12, "down");
            const nyLowY = 320;
            const nyHighY = 80;
            overlay = (
              <g>
                <line
                  x1="50"
                  y1={nyHighY}
                  x2="550"
                  y2={nyHighY}
                  stroke="#ef4444"
                  strokeWidth="2"
                  strokeDasharray="5,5"
                  opacity="0.5"
                />
                <line
                  x1="50"
                  y1={nyLowY}
                  x2="550"
                  y2={nyLowY}
                  stroke="#10b981"
                  strokeWidth="2"
                  strokeDasharray="5,5"
                  opacity="0.5"
                />
                <text
                  x="560"
                  y={nyHighY}
                  fill="#ef4444"
                  fontSize="12"
                  alignmentBaseline="middle"
                >
                  High
                </text>
                <text
                  x="560"
                  y={nyLowY}
                  fill="#10b981"
                  fontSize="12"
                  alignmentBaseline="middle"
                >
                  Low
                </text>
                {state.showProb && (
                  <>
                    <g transform="translate(450, 90)">
                      <rect
                        width="90"
                        height="36"
                        fill="#1e293b"
                        stroke="#ef4444"
                        rx="4"
                      />
                      <text
                        x="45"
                        y="23"
                        textAnchor="middle"
                        fill="#ef4444"
                        fontSize="14"
                        fontWeight="bold"
                      >
                        18.3%
                      </text>
                    </g>
                    <g transform="translate(450, 270)">
                      <rect
                        width="90"
                        height="36"
                        fill="#1e293b"
                        stroke="#10b981"
                        rx="4"
                      />
                      <text
                        x="45"
                        y="23"
                        textAnchor="middle"
                        fill="#10b981"
                        fontSize="14"
                        fontWeight="bold"
                      >
                        81.7%
                      </text>
                    </g>
                    <path
                      d={`M 320,200 Q 380,200 400,${
                        nyLowY + 20
                      }`}
                      fill="none"
                      stroke="#10b981"
                      strokeWidth="3"
                      strokeDasharray="100"
                      strokeDashoffset={100 - state.progress * 100}
                      markerEnd="url(#arrowhead-green)"
                    />
                  </>
                )}
              </g>
            );
            break;
          }

          case "london_session": {
            candles = generateCandles(1.2, 12, "up");
            const lonLowY = 300;
            const lonHighY = 100;
            overlay = (
              <g>
                <line
                  x1="50"
                  y1={lonHighY}
                  x2="550"
                  y2={lonHighY}
                  stroke="#10b981"
                  strokeWidth="2"
                  strokeDasharray="5,5"
                  opacity="0.5"
                />
                <line
                  x1="50"
                  y1={lonLowY}
                  x2="550"
                  y2={lonLowY}
                  stroke="#ef4444"
                  strokeWidth="2"
                  strokeDasharray="5,5"
                  opacity="0.5"
                />
                {state.showProb && (
                  <>
                    <g transform="translate(450, 50)">
                      <rect
                        width="90"
                        height="36"
                        fill="#1e293b"
                        stroke="#10b981"
                        rx="4"
                      />
                      <text
                        x="45"
                        y="23"
                        textAnchor="middle"
                        fill="#10b981"
                        fontSize="14"
                        fontWeight="bold"
                      >
                        70.3%
                      </text>
                    </g>
                    <g transform="translate(450, 310)">
                      <rect
                        width="90"
                        height="36"
                        fill="#1e293b"
                        stroke="#ef4444"
                        rx="4"
                      />
                      <text
                        x="45"
                        y="23"
                        textAnchor="middle"
                        fill="#ef4444"
                        fontSize="14"
                        fontWeight="bold"
                      >
                        29.7%
                      </text>
                    </g>
                    <path
                      d={`M 320,250 Q 380,200 400,${
                        lonHighY - 20
                      }`}
                      fill="none"
                      stroke="#10b981"
                      strokeWidth="3"
                      strokeDasharray="100"
                      strokeDashoffset={100 - state.progress * 100}
                      markerEnd="url(#arrowhead-green)"
                    />
                  </>
                )}
              </g>
            );
            break;
          }

          case "metrics": {
            candles = generateCandles(1.5, 10, "up");
            const sweepHighY = 120;
            overlay = (
              <g>
                <line
                  x1="50"
                  y1={sweepHighY}
                  x2="550"
                  y2={sweepHighY}
                  stroke="#64748b"
                  strokeWidth="1"
                  strokeDasharray="5,5"
                />
                <text
                  x="560"
                  y={sweepHighY}
                  fill="#64748b"
                  fontSize="12"
                  alignmentBaseline="middle"
                >
                  Sweep Level
                </text>

                {state.progress > 0.1 && (
                  <path
                    d={`M 280,${sweepHighY + 10} L 300,${
                      sweepHighY - 20
                    } L 320,${sweepHighY + 5}`}
                    fill="none"
                    stroke="#ef4444"
                    strokeWidth="2"
                  />
                )}

                {state.progress > 0.5 && (
                  <g opacity={(state.progress - 0.5) * 2}>
                    <line
                      x1="300"
                      y1={sweepHighY - 20}
                      x2="300"
                      y2={sweepHighY - 100}
                      stroke="#10b981"
                      strokeWidth="2"
                      markerEnd="url(#arrowhead-green)"
                    />
                    <line
                      x1="290"
                      y1={sweepHighY - 100}
                      x2="310"
                      y2={sweepHighY - 100}
                      stroke="#10b981"
                      strokeWidth="1"
                    />
                    <text
                      x="320"
                      y={sweepHighY - 60}
                      fill="#10b981"
                      fontSize="12"
                    >
                      MEDIAN PENETRATION
                    </text>
                    <text
                      x="320"
                      y={sweepHighY - 45}
                      fill="white"
                      fontSize="14"
                      fontWeight="bold"
                    >
                      ~39 PTS
                    </text>
                  </g>
                )}
              </g>
            );
            break;
          }

          case "silver_bullet": {
            candles = [];
            overlay = (
              <g>
                <line
                  x1="50"
                  y1="200"
                  x2="550"
                  y2="200"
                  stroke="#334155"
                  strokeWidth="2"
                />
                {[
                  { label: "London", x: 100, color: "#3b82f6", prob: "68% High" },
                  { label: "NY AM", x: 230, color: "#10b981", prob: "72% Low" },
                  { label: "NY PM", x: 360, color: "#f59e0b", prob: "60% High" },
                  { label: "Power Hr", x: 490, color: "#ef4444", prob: "Consol." },
                ].map((win, i) => (
                  <g
                    key={i}
                    opacity={state.progress > i * 0.25 ? 1 : 0.2}
                    transform={`translate(${win.x}, 200)`}
                  >
                    <circle r="8" fill={win.color} />
                    <line
                      x1="0"
                      y1="0"
                      x2="0"
                      y2="-40"
                      stroke={win.color}
                      strokeWidth="1"
                      strokeDasharray="2,2"
                    />
                    <rect
                      x="-35"
                      y="-70"
                      width="70"
                      height="30"
                      rx="4"
                      fill="#1e293b"
                      stroke={win.color}
                    />
                    <text
                      x="0"
                      y="-50"
                      textAnchor="middle"
                      fill={win.color}
                      fontSize="10"
                      fontWeight="bold"
                    >
                      {win.label}
                    </text>
                    <g
                      opacity={state.progress > i * 0.25 + 0.1 ? 1 : 0}
                      transform="translate(0, 30)"
                    >
                      <text
                        x="0"
                        y="0"
                        textAnchor="middle"
                        fill="white"
                        fontSize="10"
                      >
                        {win.prob}
                      </text>
                    </g>
                  </g>
                ))}
                <text
                  x="300"
                  y="320"
                  textAnchor="middle"
                  fill="#94a3b8"
                  fontSize="14"
                >
                  4 Distinct Algorithms. 4 Unique Opportunities.
                </text>
              </g>
            );
            break;
          }

          case "confluence": {
            const cProbHighY = 80;
            let baseCandles = [
              { x: 60, open: 220, close: 245, high: 215, low: 250 },
              { x: 90, open: 245, close: 310, high: 245, low: 315 },
              { x: 120, open: 310, close: 320, high: 290, low: 330 },
              { x: 150, open: 320, close: 300, high: 300, low: 325 },
              { x: 180, open: 300, close: 260, high: 260, low: 305 },
              { x: 210, open: 260, close: 230, high: 225, low: 265 },
              { x: 240, open: 230, close: 200, high: 195, low: 255 },
              { x: 270, open: 200, close: 150, high: 145, low: 205 },
              { x: 300, open: 150, close: 100, high: 95, low: 155 },
            ];

            const visible = baseCandles.slice(
              0,
              Math.floor(state.progress * baseCandles.length) + 1
            );

            const fvgTop = 250;
            const fvgBottom = 290;
            const fvgPresent = visible.length > 2;
            const isInverted = visible.length > 5;

            const fvgColor = isInverted ? "#10b981" : "#ef4444";
            const fvgOpacity = isInverted ? 0.2 : 0.3;
            const fvgText = isInverted ? "iFVG (Inverted)" : "Bearish FVG";

            overlay = (
              <g>
                {fvgPresent && (
                  <g>
                    <rect
                      x="60"
                      y={fvgTop}
                      width={500}
                      height={fvgBottom - fvgTop}
                      fill={fvgColor}
                      opacity={fvgOpacity}
                    />
                    <line
                      x1="60"
                      y1={fvgTop}
                      x2="560"
                      y2={fvgTop}
                      stroke={fvgColor}
                      strokeWidth="1"
                      strokeDasharray="2,2"
                    />
                    <line
                      x1="60"
                      y1={fvgBottom}
                      x2="560"
                      y2={fvgBottom}
                      stroke={fvgColor}
                      strokeWidth="1"
                      strokeDasharray="2,2"
                    />
                    <text
                      x="550"
                      y={fvgTop + 25}
                      textAnchor="end"
                      fill={fvgColor}
                      fontSize="12"
                      fontWeight="bold"
                    >
                      {fvgText}
                    </text>
                  </g>
                )}

                <line
                  x1="50"
                  y1={cProbHighY}
                  x2="550"
                  y2={cProbHighY}
                  stroke="#10b981"
                  strokeWidth="2"
                  strokeDasharray="5,5"
                  opacity="0.5"
                />
                <text
                  x="500"
                  y={cProbHighY - 10}
                  fill="#10b981"
                  fontSize="10"
                >
                  Probable High Target
                </text>

                {visible.length > 6 && (
                  <g transform="translate(255, 250)">
                    <circle r="4" fill="#10b981" />
                    <text
                      x="10"
                      y="5"
                      fill="#10b981"
                      fontSize="10"
                      fontWeight="bold"
                    >
                      ENTRY
                    </text>
                  </g>
                )}
              </g>
            );

            candles = visible;
            break;
          }

          case "psychology": {
            candles = [];
            overlay = (
              <g>
                <path
                  d="M 50,300 C 80,200 100,350 150,280 S 200,380 250,300 S 300,150 350,320"
                  fill="none"
                  stroke="#ef4444"
                  strokeWidth="1"
                  opacity={1 - state.progress}
                />
                <text
                  x="100"
                  y="360"
                  fill="#ef4444"
                  fontSize="12"
                  opacity={1 - state.progress}
                >
                  EMOTIONAL CHAOS
                </text>

                <path
                  d={`M 50,300 L ${
                    50 + 500 * state.progress
                  }, ${300 - 200 * state.progress}`}
                  fill="none"
                  stroke="#10b981"
                  strokeWidth="4"
                />

                <g
                  transform={`translate(${
                    50 + 500 * state.progress
                  }, ${300 - 200 * state.progress})`}
                >
                  {state.progress > 0 && <circle r="6" fill="#10b981" />}
                  {state.progress > 0.5 && (
                    <g transform="translate(-80, -20)">
                      <rect
                        width="100"
                        height="30"
                        fill="#1e293b"
                        rx="4"
                        stroke="#10b981"
                      />
                      <text
                        x="50"
                        y="20"
                        textAnchor="middle"
                        fill="#10b981"
                        fontSize="12"
                        fontWeight="bold"
                      >
                        CONFIDENCE
                      </text>
                    </g>
                  )}
                </g>

                <text
                  x="300"
                  y="100"
                  textAnchor="middle"
                  fill="white"
                  fontSize="24"
                  opacity={state.progress}
                >
                  NO EMOTION. PURE STATS.
                </text>
              </g>
            );
            break;
          }

          case "gold": {
            const startP = 350;
            const endP = 50;
            const steps = 15;

            let base = Array.from({ length: steps }).map((_, i) => {
              const progress = i / (steps - 1);
              const targetY = startP - progress * (startP - endP);
              const noise = Math.sin(i * 1.5) * 15;
              const open = targetY + noise;
              const isGreen = Math.random() > 0.3;
              const close = isGreen
                ? open - (Math.random() * 20 + 5)
                : open + Math.random() * 10;

              return {
                x: 50 + i * 35,
                open,
                close,
                high: Math.min(open, close) - Math.random() * 10,
                low: Math.max(open, close) + Math.random() * 10,
              };
            });

            const visibleGoldCandles = base.slice(
              0,
              Math.floor(state.progress * steps) + 1
            );
            candles = visibleGoldCandles;

            const goldTargetY = 50;

            overlay = (
              <g>
                <line
                  x1="50"
                  y1={goldTargetY}
                  x2="550"
                  y2={goldTargetY}
                  stroke="#10b981"
                  strokeWidth="2"
                  strokeDasharray="5,5"
                />
                <text
                  x="480"
                  y={goldTargetY - 10}
                  fill="#10b981"
                  fontSize="12"
                >
                  MORE PROBABLE HIGH
                </text>

                <g transform={`translate(300, ${goldTargetY})`}>
                  <circle
                    r={state.progress * 300}
                    fill="none"
                    stroke="#10b981"
                    strokeWidth="1"
                    opacity={1 - state.progress}
                  />
                  <circle
                    r={(state.progress * 300) / 2}
                    fill="none"
                    stroke="#10b981"
                    strokeWidth="1"
                    opacity={1 - state.progress}
                  />
                </g>

                {visibleGoldCandles.length > 0 && (
                  <path
                    d={`M ${
                      visibleGoldCandles[visibleGoldCandles.length - 1].x
                    },${
                      visibleGoldCandles[visibleGoldCandles.length - 1].close
                    } L 350,${goldTargetY + 20}`}
                    fill="none"
                    stroke="#10b981"
                    strokeWidth="2"
                    strokeDasharray="5,5"
                    opacity="0.3"
                  />
                )}
              </g>
            );
            break;
          }

          case "offer": {
            candles = [];
            overlay = (
              <g

